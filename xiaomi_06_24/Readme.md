## 小米面试总结 06-24

---------------
[TOC]

### 0 背景
**2014年6月23日，阴**

自从上次小米面试失败之后，就没想着再去小米面。一方面觉得不自信，另一方面也觉得万一又没过，肯定很没面子。所以去西安之前面了一下小公司，待遇也不好，但我基本上就开始得过且过地觉得就这样吧。

前一天晚上坐火车，23号早上刚刚到北京，睡了一觉到下午两点。起床后觉得无所事事。大约四点钟的时候来了一通电话，小米的HR约去进行第二次面试。丝毫没有由于就答应了，似乎一直在等着似得。但挂了电话开始担心，开始临阵抱佛脚地敲代码，期待明天遇到一道题。

**2014年6月24日，阴有小雨**
24号上午十一点多才起床，因为两点半就要面试，没时间午睡，甚至午饭都没好好吃就去面试了，一路上还算平静，到了之后竟开始有点信心，等待面试官到来。没等多久就开始面试。跟上次面试地点不同，这次是新办公楼，甲醛味很重，但是没几个人，我喜欢。
### 1 项目讨论
上来还是一样，自我介绍。简单说两句就引入到项目。简历上一共写了三个项目，1.Gears，2.社交网络采集系统，3.高并发服务器。我没想过要讲多细致，就觉得只要他不打断我就一直讲下去，没什么说的了就讲下一个。感觉他对我的项目还比较感兴趣，每一个都问了具体的架构和流程，自认为答得不错，至少他问的问题都说上来了。但是还是有点遗憾，很多细节没想到要说，很多工作都是很有趣很有意义的，也没轮的上说。但应该已经过了快一个小时了。

具体来讲，项目主要围绕总体架构、流程、个别实现细节。三个方面。所以针对每个项目，应该很清楚它的结构。必须能画出很清晰的结构图和流程图。另外对于简历提到的关键字，要弄清楚。这些都是他能问到的点。

Gears项目的整体结构和功能要再总结得好点，不能让人听一遍之后不知道你要干嘛。工作主要集中在几方面：

1. 邻居发现、连接建立、收发数据抽取，减少重复工作和资源浪费
2. 开放接口，易于扩展
3. 数据模型采用Yang模型，易于扩展
4. 数据库，易于数据共享

爬虫项目比较多坑，毕竟没有系统学习过爬虫，但大概还说的上来。想办法用专业一点的词来描述，工作没少做，话没多说。至于项目，就说已经商用，这样也没人问它采集的数据量了。

高并发服务器，一定要再了解一下**epoll**，几乎每个面试官都会问。另外，网络编程和多线程编程也还有坑。再了解一下**异步I/O**。

除了这三个项目，还要能想要其他项目，可能会提到。首先就是**MCU管理系统**，至少是一个商用产品，应该会比较被认可。还有本科做的一些网站，**OJ、微博**等。最后，一些小程序也可以，比如**多拓扑展示系统、2048、mp3播放器**等。

以前的自信来自于动手多，做的东西多。现在缺乏自信也是由于花太多时间在实践上，理论和基础不太好。把自己擅长的一面要展现的淋漓尽致才行。

### 2 手写代码
问过项目之后，开始出题手写代码。这次面试手写代码也很失败。总共出了两个题目。

1. 用两个堆栈实现队列

面试官说出这个题目之后，我心中一喜。昨天看《剑指offer》的时候晃了一眼这题，以为是志在必得。检查都没检查，写完之后马上递给面试官，心想面试官肯定满意。不料逻辑出错了。当时没仔细看这题，想当然以为这样可以，但却想错了。面试官很快就说“逻辑有问题”，让我再看看。这段时间其实自己还不相信，再加上有点慌了，看不进去，假装思考一下就说应该没问题。面试官说出测试用例之后，我一惊，这么普遍的用例竟然出错。又想了一下实在没相出怎么改。最后是面试官点明之后才明白。

代码如下：

```c++

template <typename T>
class Squeue
{
	private:
		stack<T> stackA;
		stack<T> stackB;
		void restore();
	public:
		Squeue():stackA(), stackB(){}
		void push(const T&);
		void pop();
		T &top();
};

template <typename T>
void Squeue<T>::push(const T &elem)
{
	stackA.push(elem);
}

template <typename T>
void Squeue<T>::pop()
{
	//当时的代码没有这句判断
	if(stackB.empty())restore();
	stackB.pop();
}

template <typename T>
T & Squeue<T>::top()
{
	//当时的代码没有这句判断
	if(stackB.empty())restore();
	return stackB.top();
}

template <typename T>
void Squeue<T>::restore()
{
	while(!stackA.empty())
	{
		stackB.push(stackA.top());
		stackA.pop();
	}
}
```
太晕了！

我觉得当时面试官已经很失望了，前面长篇大论地讨论项目，头头是道，写个这个简单的代码，却出逻辑问题，这基础该是多不扎实。但我觉得他认为我是一时大意，然后就给我出了另一个题目。

2.找出无重复整数序列里第k大的数。
这题也遇到过，说不定还编过代码。当时还搜了一下，有很多种方法。其中记忆深刻的是类似快排的思想。这次他不着急让我写代码，让我先说一下思路。可能怕我再脑袋一热想当然了。我给他大概讲了一下，他说可以，然后就开始写代码。

我的天！平时很简单的代码竟然写了有查不到半个小时。我都不知道我是怎么熬住的。就一个快拍的middle函数，以前记住的，现在竟有点混乱，还想不通！写得乱七八糟。好歹是写出来了。他看了一下，提出了一些质疑，我都解释完了。代码如下：

```c++

int middle(int *a, int n)
{
	int i, j;
	int tmp = a[0];
	i = 0; j = n - 1;
	while(i < j)
	{
		while(i < j && a[j] <= tmp)j--;
		if(i < j)a[i++] = a[j];
		while(i < j && a[i] > tmp)i++;
		if(i < j)a[j--] = a[i];
	}
	a[i] = tmp;
	return i;
}

int find_kth_max(int *a, int n, int k)
{
	if(n == 1 && k == 1)return a[0];
	int i, j, mid;
	mid = middle(a, n);
	if(mid + 1 > k)return find_kth_max(a, mid, k);
	else if(mid + 1 < k)return find_kth_max(a + mid + 1, n - mid - 1, k - mid - 1);
	if(mid + 1 == k)return a[mid];
}

```

当时竟然用从小到大排，显然不知道灵活变通。这题明显从大到小更清晰。还有middle函数一定要记住。理解。

接着就不再问我东西，开始说出那句“今天就到这吧”，我知道大概没戏了。然后他去找同事给我二面，结果同事有事开会，就没面成。我象征性地问了他几个问题，就离开了。

### 3总结
虽然有点丢人，两次面试都弄成这样，但也不能说没收获。至少看到了自己的弱点，那就是手写代码。看得还是少，还是不仔细。接下来不管去不去实习，都必须腾出时间多练习、总结。我知道开始觉得不擅长的事，随着自己的深入会逐渐找到感觉，一旦找到感觉，就会顺风顺水了。

**2014年6月25日，阴有小雨**

上午十一点左右，突然又接到小米HR的电话。有点模模糊糊地说可能会给我offer，有点意外。但是竟然真的又有些期待了。真难想像最初以为自己能拿下BAT，现在拿个小米都这么困难。TAT

努力吧！找工作的战役才刚刚开始，说不定谁能笑到最后。

6.25晚